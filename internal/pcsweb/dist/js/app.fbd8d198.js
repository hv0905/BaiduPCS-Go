(function(e){function t(t){for(var n,i,o=t[0],c=t[1],l=t[2],u=0,h=[];u<o.length;u++)i=o[u],r[i]&&h.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(h.length)h.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,i=1;i<a.length;i++){var c=a[i];0!==r[c]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},r={app:0},s=[];function i(e){return o.p+"js/"+({download:"download"}[e]||e)+"."+{download:"95382919"}[e]+".js"}function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(e){var t=[],a=r[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise(function(t,n){a=r[e]=[t,n]});t.push(a[2]=n);var s,c=document.getElementsByTagName("head")[0],l=document.createElement("script");l.charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.src=i(e),s=function(t){l.onerror=l.onload=null,clearTimeout(u);var a=r[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src,i=new Error("Loading chunk "+e+" failed.\n("+n+": "+s+")");i.type=n,i.request=s,a[1](i)}r[e]=void 0}};var u=setTimeout(function(){s({type:"timeout",target:l})},12e4);l.onerror=l.onload=s,c.appendChild(l)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/dist/",o.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=l;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"07d0":function(e,t,a){},"2ff3":function(e,t,a){},"352e":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("097d");var n=a("2b0e"),r=a("e069"),s=a.n(r),i=(a("dcad"),a("352e"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view",{attrs:{name:"nav"}}),a("router-view")],1)}),o=[],c=a("2877"),l={},u=Object(c["a"])(l,i,o,!1,null,null,null);u.options.__file="App.vue";var d=u.exports,h=a("8c4f"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-file-manager")},f=[],m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-file-manager"},[a("Modal",{model:{value:e.modalFlag,callback:function(t){e.modalFlag=t},expression:"modalFlag"}},[a("v-file-select",{ref:"fileSelect"}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"success",long:""},on:{click:e.confirmUpload}},[a("Icon",{attrs:{type:"md-cloud-upload"}}),e._v("上传")],1)],1)],1),a("Sider",{attrs:{width:300,"hide-trigger":""}},[a("Tree",{attrs:{data:e.folders,"load-data":e.loadData},on:{"on-select-change":e.treeSelect}})],1),a("div",{staticClass:"p-main"},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:"/"},nativeOn:{click:function(t){e.clickBreadItem(-1)}}},[a("Icon",{attrs:{type:"ios-home-outline"}}),e._v("主目录")],1),e._l(e.bread_item,function(t,n){return a("BreadcrumbItem",{key:n,attrs:{to:"/"},nativeOn:{click:function(t){e.clickBreadItem(n)}}},[e._v(e._s(t))])})],2),a("div",{staticClass:"p-content"},[e.spin_show?a("Spin",{attrs:{size:"large",fix:""}}):e._e(),a("div",{staticClass:"row-tools"},[a("div",{staticClass:"t-l"},[a("label",{staticClass:"v-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isCheckAll,expression:"isCheckAll"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isCheckAll)?e._i(e.isCheckAll,null)>-1:e.isCheckAll},on:{change:function(t){var a=e.isCheckAll,n=t.target,r=!!n.checked;if(Array.isArray(a)){var s=null,i=e._i(a,s);n.checked?i<0&&(e.isCheckAll=a.concat([s])):i>-1&&(e.isCheckAll=a.slice(0,i).concat(a.slice(i+1)))}else e.isCheckAll=r}}}),a("span")]),a("Dropdown",{staticStyle:{"margin-right":"16px"},on:{"on-click":e.fileSort}},[a("Icon",{staticStyle:{cursor:"pointer"},attrs:{type:"md-swap",size:"24"}}),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"name-asc"}},[e._v("名称 - 升序")]),a("DropdownItem",{attrs:{name:"name-desc"}},[e._v("名称 - 降序")]),a("DropdownItem",{attrs:{name:"size-asc"}},[e._v("大小 - 升序")]),a("DropdownItem",{attrs:{name:"size-desc"}},[e._v("大小 - 降序")]),a("DropdownItem",{attrs:{name:"time-asc"}},[e._v("时间 - 升序")]),a("DropdownItem",{attrs:{name:"time-desc"}},[e._v("时间 - 降序")])],1)],1),a("Input",{staticStyle:{width:"auto"},attrs:{suffix:"ios-search",search:"",clearable:"",placeholder:"在当前文件夹下搜索..."},on:{"on-search":e.searchKeyword},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.offlineDownload}},[a("Icon",{attrs:{type:"md-link"}}),e._v("离线下载")],1)],1),a("div",{staticClass:"t-r"},[a("ButtonGroup",{staticClass:"c-btn-group"},[a("Button",{on:{click:function(t){e.addItemToClipboard("copy")}}},[a("Icon",{attrs:{type:"md-copy"}}),e._v("复制")],1),a("Button",{on:{click:function(t){e.addItemToClipboard("move")}}},[a("Icon",{attrs:{type:"md-cut"}}),e._v("剪切")],1),a("Button",{on:{click:e.pasteClipboard}},[a("Icon",{attrs:{type:"md-clipboard"}}),e._v("粘贴")],1),a("Button",{on:{click:e.shareFiles}},[a("Icon",{attrs:{type:"md-share"}}),e._v("分享")],1),a("Button",{attrs:{type:"info"},on:{click:e.mkdirFunc}},[a("Icon",{attrs:{type:"md-add"}}),e._v("新建")],1),a("Button",{attrs:{type:"error"},on:{click:e.removeFiles}},[a("Icon",{attrs:{type:"md-trash"}}),e._v("删除")],1),a("Button",{attrs:{type:"success"},on:{click:function(t){e.modalFlag=!0}}},[a("Icon",{attrs:{type:"md-cloud-upload"}}),e._v("上传")],1),a("Button",{attrs:{type:"primary"},on:{click:e.downloadFiles}},[a("Icon",{attrs:{type:"md-download"}}),e._v("下载")],1)],1)],1)]),a("div",{staticClass:"table-wrap"},[a("table",{staticClass:"table files-table"},[e._m(0),e._m(1),a("tbody",e._l(e.current_folders,function(t){return a("tr",[a("td",[a("label",{staticClass:"v-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedFiles,expression:"checkedFiles"}],attrs:{type:"checkbox",name:"filePath"},domProps:{value:t.path,checked:Array.isArray(e.checkedFiles)?e._i(e.checkedFiles,t.path)>-1:e.checkedFiles},on:{change:function(a){var n=e.checkedFiles,r=a.target,s=!!r.checked;if(Array.isArray(n)){var i=t.path,o=e._i(n,i);r.checked?o<0&&(e.checkedFiles=n.concat([i])):o>-1&&(e.checkedFiles=n.slice(0,o).concat(n.slice(o+1)))}else e.checkedFiles=s}}}),a("span")])]),a("td",[a("div",{staticClass:"item-title",class:{"is-dir":t.isdir}},[a("div",{staticClass:"t-content",on:{click:function(a){e.openDir(t)}}},[t.isdir?a("Icon",{attrs:{type:"ios-folder-outline",size:"24"}}):e._e(),t.isdir?e._e():a("Icon",{attrs:{type:"ios-document",size:"24"}}),a("span",[e._v(e._s(t.title))])],1),a("div",{staticClass:"t-buttons"},[a("Button",{staticClass:"ivu-col-rename-btn",attrs:{size:"small",type:"text"},on:{click:function(a){a.stopPropagation(),e.renameFunc(t.title)}}},[e._v("重命名")]),a("Button",{staticClass:"ivu-col-rename-btn",attrs:{size:"small",type:"text"},on:{click:function(a){a.stopPropagation(),e.removeFile(t.path)}}},[e._v("删除")]),a("Button",{staticClass:"ivu-col-rename-btn",attrs:{size:"small",type:"text"},on:{click:function(a){a.stopPropagation(),e.downloadFile(t.path)}}},[e._v("下载")])],1)])]),a("td",[e._v(e._s(t.size))]),a("td",[e._v(e._s(t.mtime))])])}))])])],1)],1)],1)},g=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("colgroup",[a("col",{staticStyle:{width:"2%"}}),a("col",{staticStyle:{width:"50%"}}),a("col",{staticStyle:{width:"20%"}}),a("col",{staticStyle:{width:"20%"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th"),a("th",[e._v("文件名")]),a("th",[e._v("大小")]),a("th",[e._v("修改时间")])])])}],v=(a("28a5"),a("96cf"),a("3040")),_=a("c93e"),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Input",{staticStyle:{"font-size":"14px"},attrs:{search:"",placeholder:"请输入目录路径, 支持相对路径"},on:{"on-search":e.searchPath},model:{value:e.curPath,callback:function(t){e.curPath=t},expression:"curPath"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("目录路径")]),a("span",{staticStyle:{cursor:"pointer"},attrs:{slot:"append"},on:{click:e.backToParent},slot:"append"},[e._v("上级目录")])]),a("div",{staticClass:"file-list",staticStyle:{"margin-top":"10px","overflow-y":"auto","max-height":"64vh"}},[a("div",{staticClass:"l-row",staticStyle:{display:"flex","align-items":"center",height:"36px"}},[a("div",{staticClass:"r-col ivu-col-span-1",staticStyle:{width:"calc(1/24*100%)"}},[a("label",{staticClass:"v-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.isCheckAll,expression:"isCheckAll"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isCheckAll)?e._i(e.isCheckAll,null)>-1:e.isCheckAll},on:{change:function(t){var a=e.isCheckAll,n=t.target,r=!!n.checked;if(Array.isArray(a)){var s=null,i=e._i(a,s);n.checked?i<0&&(e.isCheckAll=a.concat([s])):i>-1&&(e.isCheckAll=a.slice(0,i).concat(a.slice(i+1)))}else e.isCheckAll=r}}}),a("span")])]),a("div",{staticClass:"r-col ivu-col-span-11",staticStyle:{width:"calc(11/24*100%)"}},[e._v("文件名")]),a("div",{staticClass:"r-col ivu-col-span-4",staticStyle:{width:"calc(4/24*100%)"}},[e._v("大小")]),a("div",{staticClass:"r-col ivu-col-span-8",staticStyle:{width:"calc(8/24*100%)"}},[e._v("修改时间")])]),e._l(e.fileData,function(t){return a("div",{staticClass:"l-row",staticStyle:{display:"flex","align-items":"center",height:"36px"}},[a("div",{staticClass:"r-col ivu-col-span-1",staticStyle:{width:"calc(1/24*100%)"}},[a("label",{staticClass:"v-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedFiles,expression:"checkedFiles"}],attrs:{type:"checkbox",name:"filePath"},domProps:{value:t.path,checked:Array.isArray(e.checkedFiles)?e._i(e.checkedFiles,t.path)>-1:e.checkedFiles},on:{change:function(a){var n=e.checkedFiles,r=a.target,s=!!r.checked;if(Array.isArray(n)){var i=t.path,o=e._i(n,i);r.checked?o<0&&(e.checkedFiles=n.concat([i])):o>-1&&(e.checkedFiles=n.slice(0,o).concat(n.slice(o+1)))}else e.checkedFiles=s}}}),a("span")])]),a("div",{staticClass:"r-col ivu-col-span-11",staticStyle:{width:"calc(11/24*100%)","overflow-x":"hidden","white-space":"nowrap","text-overflow":"ellipsis"},on:{dblclick:function(a){e.dblClickFolder(t)}}},[e._v(e._s(t.name))]),a("div",{staticClass:"r-col ivu-col-span-4",staticStyle:{width:"calc(4/24*100%)"}},[e._v(e._s(t.size))]),a("div",{staticClass:"r-col ivu-col-span-8",staticStyle:{width:"calc(8/24*100%)"}},[e._v(e._s(t.date.substr(0,19)))])])})],2)],1)},w=[],k={name:"v-file-select",data:function(){return{isCheckAll:!1,fileData:[],checkedFiles:[],curPath:""}},watch:{isCheckAll:function(e){this.checkedFiles=e?this.fileData.map(function(e){return e.path}):[]}},methods:{backToParent:function(){var e=this.curPath.lastIndexOf("/");-1!==e&&(this.curPath=this.curPath.substring(0,e),this.getFileList(this.curPath))},getFileList:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.checkedFiles=[],e.next=3,$axios.get("local_file?method=list&path=".concat(encodeURIComponent(t))).catch(this.error);case 3:a=e.sent,0===a.data.code?(this.fileData=a.data.data,n=this.fileData[0].path,this.curPath=n.substring(0,n.lastIndexOf("/"))):this.error(a.data.msg);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),dblClickFolder:function(e){e.isdir&&this.getFileList(e.path)},searchPath:function(){this.getFileList(this.curPath)}},mounted:function(){this.getFileList(".")}},y=k,x=Object(c["a"])(y,b,w,!1,null,null,null);x.options.__file="FileSelect.vue";var S=x.exports,C=a("c276"),D=a("2f62"),I={name:"v-file-manager",data:function(){return{spin_show:!1,folders:[{title:"主目录",path:"/",loading:!1,expand:!0,children:[]}],files_view_mode:2,current_folders:[],bread_item:[],checkGroup:[],clipboard:[],clipboard_method:"",checkAll:!1,isCheckAll:!1,indeterminate:!1,new_folder_name:"",modalFlag:!1,searchKey:"",downloadLink:"",new_file_name:"",checkedFiles:[]}},computed:Object(_["a"])({},Object(D["c"])(["globals","websocket"])),components:{VFileSelect:S},watch:{isCheckAll:function(e){this.checkedFiles=e?this.current_folders.map(function(e){return e.path}):[]}},methods:Object(_["a"])({},Object(D["b"])(["initWS"]),{getPathData:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t,a){var n,r,s,i,o,c,l,u,d,h=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=h.length>2&&void 0!==h[2]&&h[2],r=h.length>3&&void 0!==h[3]?h[3]:"none",s=h.length>4&&void 0!==h[4]?h[4]:"none",this.spin_show=!0,null==localStorage["baidupcs_file_sort"]?"none"===r&&(r="name",s="asc"):(i=localStorage["baidupcs_file_sort"].split("-"),r=i[0],s=i[1]),o=[],e.next=8,$axios.get("files?path=".concat(encodeURIComponent(t),"&order_by=").concat(r,"&order=").concat(s)).catch(this.error);case 8:for(c=e.sent,this.spin_show=!1,l=c.data.list,u=0;u<l.length;u++)d=l[u],1===d.isdir?o.push({path:d.path,title:d.server_filename,isdir:!0,size:C["a"].bytesToSize(d.size),mtime:C["a"].formatDateTime(1e3*d.server_mtime),ctime:C["a"].formatDateTime(1e3*d.server_ctime),loading:!1,children:[]}):!1===n&&o.push({path:d.path,title:d.server_filename,size:C["a"].bytesToSize(d.size),mtime:C["a"].formatDateTime(1e3*d.server_mtime),ctime:C["a"].formatDateTime(1e3*d.server_ctime),isdir:!1});a(o);case 13:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),resetCheckGroup:function(){this.isCheckAll=!1,this.checkedFiles=[]},setCurrentFolder:function(e){this.current_folders=e,this.resetCheckGroup()},setBreadPath:function(e){this.bread_item=e.split("/"),this.bread_item.splice(0,1)},openDir:function(e){e.isdir&&(this.getPathData(e.path,this.setCurrentFolder),this.setBreadPath(e.path))},clickBreadItem:function(e){var t="/",a=this.bread_item;while(a.length>e+1)a.pop();t+=a.join("/"),this.getPathData(t,this.setCurrentFolder),this.setBreadPath(t)},treeSelect:function(e){0!==e.length&&(this.getPathData(e[0].path,this.setCurrentFolder),this.setBreadPath(e[0].path))},loadData:function(e,t){this.getPathData(e.path,t,!0)},fileSort:function(e){localStorage.setItem("baidupcs_file_sort",e);var t=e.split("-"),a="/"+this.bread_item.join("/");this.getPathData(a,this.setCurrentFolder,!1,t[0],t[1])},addItemToClipboard:function(e){if(0===this.checkedFiles.length)return this.$Message.warning("请至少选择一个文件或者文件夹"),!1;this.clipboard=this.checkedFiles.slice(),this.clipboard_method=e;var t="copy"===e?"复制":"剪切";return""!==e&&"remove"!==e&&this.$Message.success("已经"+t+"到粘贴板"),!0},pasteClipboard:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=!(s.length>0&&void 0!==s[0])||s[0],a=this.clipboard.join("|"),n="/".concat(this.bread_item.join("/")),t&&(a+="|"+n),e.next=6,$axios.get("file_operation?method=".concat(this.clipboard_method,"&paths=").concat(encodeURIComponent(a))).catch(this.error);case 6:r=e.sent,0!==r.data.code?this.$Message.error(r.data.msg):this.getPathData(n,this.setCurrentFolder);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),removeFiles:function(){var e=this;this.$Modal.confirm({title:"确认删除吗?",content:"<p>将会把文件移至百度云回收站</p>",onOk:function(){e.addItemToClipboard("remove"),e.pasteClipboard(!1),e.resetCheckGroup()}})},removeFile:function(e){var t=this;this.$Modal.confirm({title:"确认删除吗?",content:"<p>将会把文件移至百度云回收站</p>",onOk:function(){var a=Object(v["a"])(regeneratorRuntime.mark(function a(){var n,r;return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return n="/".concat(t.bread_item.join("/")),a.next=3,$axios.get("file_operation?method=remove&paths=".concat(encodeURIComponent(e))).catch(t.error);case 3:r=a.sent,0!==r.data.code?t.$Message.error(r.data.msg):t.getPathData(n,t.setCurrentFolder);case 5:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}()})},confirmUpload:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t="/".concat(this.bread_item.join("/")),this.globals.pending_upload_data.push(t),a=this.$refs.fileSelect,0!==a.checkedFiles.length){e.next=6;break}return this.$Message.error("请至少选择一个文件"),e.abrupt("return");case 6:if(null===this.websocket&&this.initWS(),1===this.websocket.readyState){e.next=10;break}return e.next=10,C["a"].sleep(500);case 10:this.websocket.send(JSON.stringify({type:3,paths:a.checkedFiles,tpath:t})),this.$Message.success("已经添加到上传队列!"),this.modalFlag=!1;case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),downloadFiles:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.addItemToClipboard("")){e.next=2;break}return e.abrupt("return");case 2:if(null===this.websocket&&this.initWS(),1===this.websocket.readyState){e.next=6;break}return e.next=6,C["a"].sleep(500);case 6:this.websocket.send(JSON.stringify({type:2,method:"download",paths:this.clipboard})),this.$Message.success("已经添加到下载队列!"),this.resetCheckGroup();case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),downloadFile:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(null===this.websocket&&this.initWS(),1===this.websocket.readyState){e.next=4;break}return e.next=4,C["a"].sleep(500);case 4:a=new Array(t),this.websocket.send(JSON.stringify({type:2,method:"download",paths:a})),this.$Message.success("已经添加到下载队列!");case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),shareFiles:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!1!==this.addItemToClipboard("")){e.next=2;break}return e.abrupt("return");case 2:for(t="",a=0;a<this.clipboard.length;a++)t+=this.clipboard[a]+"|";return t=t.substr(0,t.length-1),e.next=7,$axios.get("share?method=set&paths=".concat(encodeURIComponent(t))).catch(this.error);case 7:n=e.sent,0===n.data.code?(this.$Message.success({content:"分享成功, 链接: "+n.data.msg,duration:10}),this.resetCheckGroup(),this.globals.share_refresh=!0):this.error(n.data.msg);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),mkdirFunc:function(){var e=this;this.$Modal.confirm({render:function(t){return t("Input",{props:{value:e.new_folder_name,autofocus:!0,placeholder:"请输入文件夹名称..."},on:{input:function(t){e.new_folder_name=t}}})},loading:!0,okText:"确认",cancelText:"取消",onOk:function(){var t=Object(v["a"])(regeneratorRuntime.mark(function t(){var a,n,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a="/".concat(e.bread_item.join("/")),n="".concat(a,"/").concat(e.new_folder_name),t.next=4,$axios.get("mkdir?path=".concat(encodeURIComponent(n)));case 4:r=t.sent,e.$Modal.remove(),e.new_folder_name="",0!==r.data.code?e.$Message.error(r.data.msg):e.getPathData(a,e.setCurrentFolder);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()})},renameFunc:function(e){var t=this;this.$Modal.confirm({render:function(a){return a("Input",{props:{value:e,autofocus:!0},on:{input:function(e){t.new_file_name=e}}})},loading:!0,okText:"确认",cancelText:"取消",onOk:function(){var a=Object(v["a"])(regeneratorRuntime.mark(function a(){var n,r,s,i;return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return n="/".concat(t.bread_item.join("/")),r="".concat(n,"/").concat(e),s="".concat(n,"/").concat(t.new_file_name),a.next=5,$axios.get("file_operation?method=move&paths=".concat(encodeURIComponent(r+"|"+s)));case 5:i=a.sent,t.$Modal.remove(),t.new_folder_name="",0!==i.data.code?t.$Message.error(i.data.msg):t.getPathData(n,t.setCurrentFolder);case 9:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}()})},searchKeyword:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s,i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.searchKey){e.next=3;break}return this.$Message.warning("请输入搜索关键字"),e.abrupt("return");case 3:return this.spin_show=!0,t="/".concat(this.bread_item.join("/")),e.next=7,$axios.get("search?tpath=".concat(encodeURIComponent(t),"&keyword=").concat(this.searchKey)).catch(this.error);case 7:for(a=e.sent,this.spin_show=!1,n=a.data.data,r=[],s=0;s<n.length;s++)i=n[s],o=i.Path.substring(0,i.Path.lastIndexOf("/")),r.push({path:i.Path,title:i.Filename,folder:o,isdir:!1,size:C["a"].bytesToSize(i.Size),mtime:C["a"].formatDateTime(1e3*i.Mtime),ctime:C["a"].formatDateTime(1e3*i.Ctime)});this.setCurrentFolder(r);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),offlineDownload:function(){var e=this;this.$Modal.confirm({render:function(t){return t("Input",{props:{value:e.downloadLink,placeholder:"下载到百度云当前目录, 支持http/https/ftp/电驴/磁力链协议"},on:{input:function(t){return e.downloadLink=t}}})},loading:!0,onOk:function(){var t=Object(v["a"])(regeneratorRuntime.mark(function t(){var a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a="/".concat(e.bread_item.join("/")),t.next=3,$axios.get("offline_download?method=add&link=".concat(encodeURIComponent(e.downloadLink),"&tpath=").concat(encodeURIComponent(a))).catch(e.error);case 3:n=t.sent,e.$Modal.remove(),e.downloadLink="",0!==n.data.code?e.error(n.data.msg):e.$Message.success("任务添加成功, ID:"+n.data.msg);case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()})},getFiles:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var a,n,r,s,i,o,c,l,u,d,h;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.spin_show=!0,a=[],n=[],r="",s="",null==localStorage["baidupcs_file_sort"]?(r="name",s="asc"):(i=localStorage["baidupcs_file_sort"].split("-"),r=i[0],s=i[1]),e.next=6,$axios.get("files?path=".concat(encodeURIComponent(t),"&order_by=").concat(r,"&order=").concat(s)).catch(this.error);case 6:if(o=e.sent,this.spin_show=!1,c=o.data,!c.error_code){e.next=12;break}return this.error(c.error_msg),e.abrupt("return");case 12:for(l=o.data.list,u=0;u<l.length;u++)d=l[u],h={path:d.path,title:d.server_filename,size:C["a"].bytesToSize(d.size),mtime:C["a"].formatDateTime(1e3*d.server_mtime),ctime:C["a"].formatDateTime(1e3*d.server_ctime)},1===d.isdir?(a.push(Object(_["a"])({},h,{isdir:!0,loading:!1,children:[]})),n.push(Object(_["a"])({},h,{isdir:!0,loading:!1,children:[]}))):a.push(Object(_["a"])({},h,{isdir:!1}));this.folders[0].children=n,this.current_folders=a;case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getWorkingDir:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("setting?method=get").catch(this.error);case 2:if(t=e.sent,a="",0===t.data.code){e.next=7;break}return this.error(t.data.msg),e.abrupt("return",a);case 7:for(n=t.data.data,r=0;r<n.length;r++)"workdir"===n[r].en_name&&(a=n[r].value);return e.abrupt("return",a);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}),mounted:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getWorkingDir();case 2:t=e.sent,""!==t&&(this.setBreadPath(t),this.getFiles(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},F=I,R=Object(c["a"])(F,m,g,!1,null,null,null);R.options.__file="FileManager.vue";var O=R.exports,$={components:{VFileManager:O}},P=$,M=Object(c["a"])(P,p,f,!1,null,null,null);M.options.__file="Home.vue";var j=M.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-login"},[a("div",{staticClass:"login-con"},[a("Card",{attrs:{icon:"log-in",title:"百度云登录",bordered:!1}},[a("div",{staticClass:"form-con"},["pwd"===e.loginWay?[a("Input",{attrs:{type:"text",clearable:"",placeholder:"用户名"},nativeOn:{keydown:function(t){e.watchkey(t)}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}},[a("Icon",{attrs:{slot:"prepend",type:"ios-person-outline"},slot:"prepend"})],1),a("Input",{attrs:{type:"password",clearable:"",placeholder:"密码"},nativeOn:{keydown:function(t){e.watchkey(t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}},[a("Icon",{attrs:{slot:"prepend",type:"ios-lock-outline"},slot:"prepend"})],1),a("Row",[a("Col",{staticStyle:{padding:"0"},attrs:{span:"14"}},[e.show_verify_types?a("Select",{attrs:{placeholder:"请选择验证方法"},on:{"on-change":e.websocketsend},model:{value:e.verify_type,callback:function(t){e.verify_type=t},expression:"verify_type"}},e._l(e.verify_types,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v("\n                  "+e._s(t.label)+"\n                ")])})):e._e(),e.verify_img?a("img",{attrs:{src:e.verify_img}}):e._e()],1),a("Col",{staticStyle:{padding:"0"},attrs:{span:"9",offset:"1"}},[e.show_verify_code?a("Input",{attrs:{type:"text",clearable:"",placeholder:"验证码"},nativeOn:{keydown:function(t){e.watchkey(t)}},model:{value:e.verify_code,callback:function(t){e.verify_code=t},expression:"verify_code"}},[a("Icon",{attrs:{slot:"prepend",type:"ios-barcode-outline"},slot:"prepend"})],1):e._e()],1)],1)]:e._e(),"bduss"===e.loginWay?[a("Input",{attrs:{type:"text",clearable:"",placeholder:"BDUSS"},model:{value:e.BDUSS,callback:function(t){e.BDUSS=t},expression:"BDUSS"}})]:e._e(),a("div",{staticClass:"row-ways"},[a("div",{staticClass:"way-bduss"},["pwd"===e.loginWay?a("a",{staticClass:"link",on:{click:function(t){e.loginWay="bduss"}}},[e._v("BDUSS登录")]):e._e(),"bduss"===e.loginWay?a("a",{staticClass:"link",on:{click:function(t){e.loginWay="pwd"}}},[e._v("密码登录")]):e._e()])]),a("Button",{attrs:{type:"success",loading:e.button_loading,long:""},on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.websocketsend(t):null},click:e.websocketsend}},[e._v("登录\n        ")])],2)]),e.users.length?a("Card",[a("Row",{staticStyle:{"text-align":"center","font-weight":"700"}},[e._v("已登录用户")]),e._l(e.users,function(t,n){return a("Row",{key:n,nativeOn:{click:function(a){e.selectUser(t)}}},[e._v(e._s(t.name))])})],2):e._e()],1)])},B=[],z=(a("7f7f"),a("db49")),T={name:"v-login",data:function(){return{loginWay:"pwd",base_url:z["a"].base_url,ws_url:z["a"].ws_url,login_status:1,username:"",password:"",verify_code:"",verify_types:null,verify_type:"",show_verify_types:!1,show_verify_code:!1,verify_img:"",button_loading:!1,websocket:null,init_websocket:!1,config:{},users:[],BDUSS:""}},methods:{initWebSocket:function(){this.websocket=new WebSocket(this.ws_url),this.websocket.onopen=this.websocketonopen,this.websocket.onerror=this.websocketonerror,this.websocket.onmessage=this.websocketonmessage,this.websocket.onclose=this.websocketclose},websocketonopen:function(){this.init_websocket=!0,console.log("WebSocket连接成功")},websocketonerror:function(e){this.$Message.error({content:"WebSocket连接发生错误 "+e,duration:10})},websocketonmessage:function(e){var t=JSON.parse(e.data);if(this.button_loading=!1,0!==t.code&&this.$Message.error({content:t.msg,duration:10,closable:!0}),1===t.type)switch(t.status){case 2:this.verify_types=JSON.parse(t.data),this.show_verify_types=!0,this.show_verify_code=!1,this.verify_img="",this.verify_code="";break;case 3:this.show_verify_code=!0,this.$Message.success({content:"验证码已发送",duration:10,closable:!0});break;case 4:this.$Message.error({content:"验证码错误",duration:10,closable:!0});break;case 5:this.$Message.error({content:"账号或者密码错误",duration:10,closable:!0});break;case 6:this.verify_img=t.msg,this.show_verify_code=!0;break;case 7:location.href="/dist",localStorage.lastUnlockTime=(new Date).getTime();break}},websocketsend:function(){if(this.button_loading=!0,"bduss"!==this.loginWay){var e={type:1,status:this.login_status,username:this.username,password:this.password};""!==this.verify_type&&(e["verify_type"]=this.verify_type),""!==this.verify_code&&(e["verify_code"]=this.verify_code),this.websocket.send(JSON.stringify(e))}else this.loginWithBDUSS()},websocketclose:function(e){console.log("connection closed ("+e+")")},watchkey:function(e){this.init_websocket||this.initWebSocket(),13===e.keyCode&&this.websocketsend()},selectUser:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("user?method=set&name=".concat(t.name)).catch(this.error);case 2:if(a=e.sent,void 0!==a){e.next=5;break}return e.abrupt("return");case 5:0===a.data.code&&(location.href="/dist");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),loginWithBDUSS:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.BDUSS){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,$axios.get("login?bduss=".concat(this.BDUSS)).catch(this.error);case 4:if(t=e.sent,void 0!==t){e.next=7;break}return e.abrupt("return");case 7:0===t.data.code&&(location.href="/dist");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},destroyed:function(){this.init_websocket&&this.websocketclose()},created:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("user?method=list").catch(this.error);case 2:if(t=e.sent,void 0!==t){e.next=5;break}return e.abrupt("return");case 5:0===t.data.code&&(this.users=t.data.data);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},A=T,U=(a("706c"),Object(c["a"])(A,L,B,!1,null,"354a0776",null));U.options.__file="Login.vue";var W=U.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Layout",[n("Header",[n("Menu",{attrs:{mode:"horizontal",theme:"dark"}},[n("router-link",{staticClass:"layout-logo",attrs:{to:"/"}},[n("img",{attrs:{src:a("cf05")}})]),n("div",{staticClass:"layout-nav"},[n("MenuItem",{attrs:{name:"1"}},[n("router-link",{attrs:{to:"/"}},[n("Icon",{attrs:{type:"md-folder"}}),e._v("文件管理")],1)],1),n("MenuItem",{attrs:{name:"2"}},[n("router-link",{attrs:{to:"/download"}},[n("Icon",{attrs:{type:"md-cloud"}}),e._v("上传下载管理")],1)],1),n("MenuItem",{attrs:{name:"share"},nativeOn:{click:function(t){e.modalShareFlag=!0}}},[n("Icon",{attrs:{type:"md-share"}}),e._v("分享管理\n        ")],1),n("MenuItem",{attrs:{name:"recycled"},nativeOn:{click:function(t){e.modalRecycleFlag=!0}}},[n("Icon",{attrs:{type:"md-trash"}}),e._v("回收站管理\n        ")],1),n("Submenu",{attrs:{name:"4"}},[n("template",{slot:"title"},[n("Icon",{attrs:{type:"md-person"}}),e._v(e._s(e.user.name))],1),n("MenuItem",{attrs:{name:"profile"},nativeOn:{click:function(t){return e.showProfile(t)}}},[e._v("简介~")]),n("MenuItem",{attrs:{name:"set"},nativeOn:{click:function(t){return e.startSet(t)}}},[e._v("设置")]),n("MenuItem",{attrs:{name:"update"},nativeOn:{click:function(t){return e.startUpdate(t)}}},[e.updateFlag?n("Badge",{attrs:{dot:""}},[e._v("更新")]):n("span",[e._v("更新")])],1),n("MenuItem",{attrs:{name:"lock"},nativeOn:{click:function(t){return e.startSetLockPwd(t)}}},[e._v("设置锁定密码")]),n("MenuItem",{attrs:{name:"switch"},nativeOn:{click:function(t){return e.switchUser(t)}}},[e._v("切换账号")]),n("MenuItem",{attrs:{name:"logout"},nativeOn:{click:function(t){return e.logout(t)}}},[e._v("退出")])],2)],1)],1)],1),n("Modal",{attrs:{width:400},model:{value:e.modalSetLockFlag,callback:function(t){e.modalSetLockFlag=t},expression:"modalSetLockFlag"}},[n("Row",[n("i-input",{attrs:{type:"password",placeholder:"输入原锁定密码(第一次设置可不填)"},model:{value:e.oldLockPwd,callback:function(t){e.oldLockPwd=t},expression:"oldLockPwd"}})],1),n("Row",[n("i-input",{attrs:{type:"password",placeholder:"输入新锁定密码"},model:{value:e.newLockPwd,callback:function(t){e.newLockPwd=t},expression:"newLockPwd"}})],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"info"},on:{click:e.setLockPwd}},[e._v("确认")])],1)],1),n("Modal",{attrs:{width:800},model:{value:e.modalShareFlag,callback:function(t){e.modalShareFlag=t},expression:"modalShareFlag"}},[e.modalShareFlag?n("v-share"):e._e(),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"info"},on:{click:function(t){e.modalShareFlag=!1}}},[e._v("确认")])],1)],1),n("Modal",{attrs:{width:800},model:{value:e.modalRecycleFlag,callback:function(t){e.modalRecycleFlag=t},expression:"modalRecycleFlag"}},[e.modalRecycleFlag?n("v-recycle"):e._e(),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"error",loading:e.loadingRecycleFlag},on:{click:e.clearRecycle}},[e._v("清空回收站")]),n("Button",{attrs:{type:"info"},on:{click:function(t){e.modalRecycleFlag=!1}}},[e._v("确认")])],1)],1),n("Modal",{on:{"on-ok":e.updateSetting},model:{value:e.modalSettingFlag,callback:function(t){e.modalSettingFlag=t},expression:"modalSettingFlag"}},[n("div",{staticStyle:{height:"68vh",overflow:"auto"}},[e.quotaData.flag?n("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[n("i-col",{attrs:{span:"5"}},[n("p",{staticStyle:{"font-size":"16px"}},[e._v("百度云存储")])]),n("i-col",{attrs:{span:"5"}},[n("i-circle",{attrs:{percent:e.quotaData.data.percent,size:80}},[n("span",{staticStyle:{"font-size":"16px"}},[e._v(e._s(e.quotaData.data.percent)+"%")]),n("div",{staticStyle:{"font-size":"10px"}},[e._v("还剩 "+e._s(e.quotaData.data.un_used))])])],1)],1):e._e(),n("Form",{ref:"settingForm",staticStyle:{"margin-top":"16px"},attrs:{model:e.formData,"label-width":110}},e._l(e.formData.config,function(t,a){return n("FormItem",{key:a,attrs:{label:t.name}},[n("i-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),n("p",[e._v(e._s(t.desc))])],1)}))],1)])],1)},N=[],K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-recycle"},[a("table",{staticClass:"table"},[e._m(0),e._m(1),a("tbody",e._l(e.shareData,function(t){return a("tr",[a("td",[a("div",{staticClass:"col-long",staticStyle:{width:"288px"},attrs:{title:t.name}},[t.isDir&&!t.isDel?a("Icon",{attrs:{type:"ios-folder-outline",size:"24"}}):e._e(),t.isDir||t.isDel?e._e():a("Icon",{attrs:{type:"ios-document",size:"24"}}),t.isDel?a("Icon",{attrs:{type:"md-close",size:"24"}}):e._e(),e._v("\n          "+e._s(t.name)+"\n        ")],1)]),a("td",[e._v(e._s(t.password))]),a("td",[a("div",{staticClass:"col-long",staticStyle:{width:"350px"}},[e._v(e._s(t.link))])]),a("td",[a("Button",{attrs:{icon:"md-close",type:"error",ghost:""},on:{click:function(a){e.cancelShare(t.id)}}})],1)])}))])])},J=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("colgroup",[a("col",{staticStyle:{width:"40%"}}),a("col",{staticStyle:{width:"8%"}}),a("col",{staticStyle:{width:"44%"}}),a("col",{staticStyle:{width:"8%"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",[e._v("文件名")]),a("th",[e._v("密码")]),a("th",[e._v("链接")]),a("th",[e._v("操作")])])])}],G=(a("ac6a"),{name:"v-share",data:function(){return{shareData:[]}},computed:Object(_["a"])({},Object(D["c"])(["globals"])),methods:{guessDirType:function(e){var t=e.lastIndexOf(".");return!(-1!==t&&(e.length-t===4||e.length-t===5))},getShareList:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("share?method=list").catch(this.error);case 2:t=e.sent,0===t.data.code?(this.shareData=[],a=t.data.data,a.forEach(function(e){var t=e.typicalPath.split("/").pop(),a="";e.fsIds.length>1&&(a=" 等"),n.shareData.push({id:e.shareId,name:t+a,password:e.passwd||"无",link:e.shortlink,isDir:n.guessDirType(t),path:e.typicalPath,isDel:"分享的文件已被删除"===e.typicalPath||"分享已过期"===e.typicalPath})})):this.error(t.data.msg);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),cancelShare:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("share?method=cancel&id=".concat(t)).catch(this.error);case 2:if(a=e.sent,0!==a.data.code){e.next=15;break}this.$Message.success("取消分享成功"),n=0;case 6:if(!(n<this.shareData.length)){e.next=13;break}if(this.shareData[n].id!==t){e.next=10;break}return this.shareData.splice(n,1),e.abrupt("break",13);case 10:n++,e.next=6;break;case 13:e.next=16;break;case 15:this.$Message.error(a.data.msg);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},mounted:function(){this.getShareList()}}),q=G,V=(a("bc52"),Object(c["a"])(q,K,J,!1,null,"155f1f71",null));V.options.__file="Share.vue";var H=V.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-recycle"},[a("table",{staticClass:"table"},[e._m(0),e._m(1),a("tbody",e._l(e.recycleData,function(t){return a("tr",[a("td",[a("div",{staticClass:"col-long",attrs:{title:t.name}},[e._v(e._s(t.name))])]),a("td",[e._v(e._s(t.size))]),a("td",[a("div",{staticClass:"col-long",attrs:{title:t.path}},[e._v(e._s(t.path))])]),a("td",[e._v(e._s(t.leftTime))]),a("td",[a("Button",{attrs:{icon:"md-undo",type:"info",ghost:""},on:{click:function(a){e.restoreRecycle(t.fid)}}})],1),a("td",[a("Button",{attrs:{icon:"md-close",type:"error",ghost:""},on:{click:function(a){e.deleteRecycle(t.fid)}}})],1)])}))])])},Z=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("colgroup",[a("col",{staticStyle:{width:"30%"}}),a("col",{staticStyle:{width:"10%"}}),a("col",{staticStyle:{width:"30%"}}),a("col",{staticStyle:{width:"10%"}}),a("col",{staticStyle:{width:"10%"}}),a("col",{staticStyle:{width:"10%"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",[e._v("文件名")]),a("th",[e._v("文件大小")]),a("th",[e._v("文件路径")]),a("th",[e._v("剩余时间")]),a("th",[e._v("还原")]),a("th",[e._v("删除")])])])}],Q={name:"v-recycle",data:function(){return{recycleData:[]}},computed:Object(_["a"])({},Object(D["c"])(["globals"])),methods:{getRecycleList:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("recycle?method=list").catch(this.error);case 2:t=e.sent,0===t.data.code?(this.recycleData=[],a=t.data.data,a.forEach(function(e){n.recycleData.push({fid:e.fs_id,name:e.server_filename,leftTime:e.leftTime+" 天",size:C["a"].bytesToSize(e.size),path:e.path})})):this.error(t.data.msg);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),restoreRecycle:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("recycle?method=restore&fid=".concat(t)).catch(this.error);case 2:if(a=e.sent,0!==a.data.code){e.next=15;break}this.$Message.success("还原回收站文件成功"),n=0;case 6:if(!(n<this.recycleData.length)){e.next=13;break}if(this.recycleData[n].fid!==t){e.next=10;break}return this.recycleData.splice(n,1),e.abrupt("break",13);case 10:n++,e.next=6;break;case 13:e.next=16;break;case 15:this.$Message.error(a.data.msg);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),deleteRecycle:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("recycle?method=delete&fid=".concat(t)).catch(this.error);case 2:if(a=e.sent,0!==a.data.code){e.next=15;break}this.$Message.success("删除回收站文件成功"),n=0;case 6:if(!(n<this.recycleData.length)){e.next=13;break}if(this.recycleData[n].fid!==t){e.next=10;break}return this.recycleData.splice(n,1),e.abrupt("break",13);case 10:n++,e.next=6;break;case 13:e.next=16;break;case 15:this.$Message.error(a.data.msg);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},mounted:function(){this.getRecycleList()}},X=Q,ee=Object(c["a"])(X,Y,Z,!1,null,null,null);ee.options.__file="Recycle.vue";var te=ee.exports,ae={data:function(){return{modalShareFlag:!1,modalRecycleFlag:!1,modalSettingFlag:!1,quotaData:{flag:!1,data:{}},formData:{config:[]},notices:[],updateVersion:[],updateFlag:!1,modalSetLockFlag:!1,oldLockPwd:"",newLockPwd:"",loadingRecycleFlag:!1}},computed:Object(_["a"])({},Object(D["c"])(["user","login"])),components:{VShare:H,VRecycle:te},methods:{showProfile:function(){this.$Modal.success({title:"BaiduPCS-Go Web版本",content:'<i class="ivu-icon ivu-icon-ios-mail" style="font-size: 24px"></i> liuzhuoling2011@hotmail.com <br />\n                                <i class="ivu-icon ivu-icon-logo-github" style="font-size: 24px"></i> <a href="https://github.com/liuzhuoling2011/baidupcs-web" target="_blank">https://github.com/liuzhuoling2011/baidupcs-web</a> <br />\n                                <br />\n                                感谢 iikira 提供了高速, 稳定可靠的百度云后台服务<br />\n                                <i class="ivu-icon ivu-icon-logo-github" style="font-size: 24px"></i> <a href="https://github.com/iikira/BaiduPCS-Go" target="_blank">https://github.com/iikira/BaiduPCS-Go</a>'})},startSet:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.modalSettingFlag=!0,e.next=3,$axios.get("setting?method=get").catch(this.error);case 3:return t=e.sent,0===t.data.code&&(this.formData.config=t.data.data),e.next=7,$axios.get("quota").catch(this.error);case 7:a=e.sent,0===a.data.code&&(this.quotaData.data=JSON.parse(a.data.data),this.quotaData.flag=!0);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),updateSetting:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(t=this.$refs["settingForm"].model.config,a="",n=0;n<t.length;n++)a+="&"+t[n].en_name+"="+encodeURIComponent(t[n].value);return e.next=5,$axios.get("setting?method=set".concat(a)).catch(this.error);case 5:if(r=e.sent,-1!==r.data.code){e.next=9;break}return this.$Message.error({content:r.data.msg,duration:10}),e.abrupt("return");case 9:this.$Message.success("配置保存成功");case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),startUpdate:function(){for(var e="",t=1;t<this.updateVersion.length;t++){var a="http://".concat(this.updateVersion[t]);e+='<a href="'+a+'">'+a+"</a><br />"}""===e&&(e="您目前使用的版本是最新的, 无需更新!"),this.$Modal.info({width:600,title:"可以升级的版本如下, 下载后请替换本程序",content:e})},logout:function(){this.$Modal.confirm({title:"退出登录",onOk:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("logout");case 2:location.reload();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()})},getUpdate:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("setting?method=update").catch(this.error);case 2:t=e.sent,0===t.data.code&&(this.updateVersion=JSON.parse(t.data.data).data.filename,this.updateVersion.length>1&&(this.updateFlag=!0));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getNotice:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("setting?method=notice").catch(this.error);case 2:if(t=e.sent,0===t.data.code)for(a="baidupcs_notice_time",this.notices=JSON.parse(t.data.data).data,n=0;n<this.notices.length;n++)(null==localStorage[a]||localStorage[a]<this.notices[n].CreatedAt)&&(localStorage.setItem(a,this.notices[n].CreatedAt),this.$Notice.info({top:50,duration:10,title:"温馨提示",desc:this.notices[n].Msg}));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),startSetLockPwd:function(){this.lockPwd="",this.modalSetLockFlag=!0},setLockPwd:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("password?method=set&oldpass=".concat(this.oldLockPwd,"&password=").concat(this.newLockPwd)).catch(this.error);case 2:t=e.sent,0===t.data.code&&(this.$Message.success("设置成功"),this.modalSetLockFlag=!1,localStorage.lastUnlockTime=(new Date).getTime()),-3===t.data.code&&this.$Message.error(t.data.msg);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),switchUser:function(){this.$router.push("/login")},clearRecycle:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingRecycleFlag=!0,e.next=3,$axios.get("recycle?method=clear").catch(this.error);case 3:t=e.sent,0===t.data.code&&(this.loadingRecycleFlag=!1,this.modalRecycleFlag=!1,this.$Message.success("清空回收站成功"));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},mounted:function(){this.getUpdate(),this.getNotice()}},ne=ae,re=(a("67a3"),Object(c["a"])(ne,E,N,!1,null,"c982d350",null));re.options.__file="Nav.vue";var se=re.exports,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",[a("Modal",{attrs:{width:400},model:{value:e.isShowModal,callback:function(t){e.isShowModal=t},expression:"isShowModal"}},[a("i-input",{attrs:{type:"password",placeholder:"输入锁定密码"},model:{value:e.lockPwd,callback:function(t){e.lockPwd=t},expression:"lockPwd"}}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"info"},on:{click:e.unlock}},[e._v("确认")])],1)],1)],1)},oe=[],ce=(a("a481"),{data:function(){return{isShowModal:!0,lockPwd:""}},methods:Object(_["a"])({},Object(D["b"])(["setIsLock"]),{unlock:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$axios.get("password?method=verify&password=".concat(this.lockPwd)).catch(this.error);case 2:if(t=e.sent,void 0!==t){e.next=5;break}return e.abrupt("return");case 5:0===t.data.code&&(t.data.data?(this.setIsLock(!1),this.$router.replace("/"),localStorage.lastUnlockTime=(new Date).getTime()):this.$Message.error("密码错误"));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()})}),le=ce,ue=Object(c["a"])(le,ie,oe,!1,null,null,null);ue.options.__file="Lock.vue";var de=ue.exports;a("c5f6"),a("20d6"),a("7514");function he(e,t){var a=JSON.parse(e.data);0!==a.code&&n["default"].prototype.$Message.error({content:a.msg,duration:10,closable:!0});var r=0,s={},i=JSON.parse(a.data.replace(/\\/g,"/"));if(2===a.type)switch(a.status){case 1:var o=i.path.split("/");t.globals.downloading.push({LastID:i.LastID,path:i.path,name:o.pop(),speed:"0KB",avg_speed:"0KB",time_used:"0s",download_size:"0KB",total_size:"--KB",time_left:"--s",percent:0,is_pause:!1,status:a.status});break;case 2:for(var c=0;c<t.globals.downloading.length;c++)if(i.path===t.globals.downloading[c].path){t.globals.downloading.splice(c,1);break}break;case 5:s=t.globals.downloading.find(function(e){return e.LastID===i.LastID}),s.is_pause||(s.speed=i.speed,s.avg_speed=i.avg_speed,s.time_used=i.time_used,s.download_size=i.download_size,s.total_size=i.total_size,s.time_left=i.time_left,s.percent=i.percent,s.status=a.status);break;case 6:s=t.globals.downloading.find(function(e){return e.LastID===i.LastID}),s.is_pause=!0,s.speed="0KB",s.avg_speed="0KB",s.time_left="--s",s.status=a.status;break;case 7:s=t.globals.downloading.find(function(e){return e.LastID===i.LastID}),s.is_pause=!1,s.status=a.status;break;case 8:r=t.globals.downloading.findIndex(function(e){return e.LastID===i.LastID}),t.globals.downloading.splice(r,1);break;case 9:r=t.globals.downloading.findIndex(function(e){return e.LastID===i.LastID}),r>=0&&(s=t.globals.downloading[r],t.globals.downloaded.push({LastID:s.LastID,path:s.path,name:s.name,speed:s.speed,avg_speed:s.avg_speed,time_used:s.time_used,download_size:s.download_size,total_size:s.total_size,time_left:"0s",percent:100,status:a.status,save_path:i.savePath}),t.globals.downloading.splice(r,1));break}if(3===a.type)switch(a.status){case 1:var l=i.path.split("/");t.globals.uploading.push({LastID:i.LastID,path:i.path,name:l.pop(),speed:"0KB",avg_speed:"0KB",time_used:"0s",uploaded_size:"0KB",total_size:"--KB",time_left:"--s",percent:0,is_pause:!1,status:a.status});break;case 2:break;case 3:r=t.globals.uploading.findIndex(function(e){return e.LastID===i.LastID}),s=t.globals.uploading[r],s.percent=100,s.status=a.status,s.save_path=i.savePath,t.globals.uploaded.push(s),t.globals.uploading.splice(r,1);break;case 4:s=t.globals.uploading.find(function(e){return e.LastID===i.LastID}),s.speed=i.speed,s.avg_speed=i.avg_speed,s.time_used=i.time_used,s.uploaded_size=i.uploaded_size,s.total_size=i.total_size,s.time_left=i.time_left,s.percent=i.percent,s.status=a.status;break;case 5:r=t.globals.uploading.findIndex(function(e){return e.LastID===i.LastID}),s=t.globals.uploading[r],t.globals.uploaded.push({LastID:s.LastID,path:s.path,name:s.name,speed:s.speed,avg_speed:s.avg_speed,time_used:s.time_used,uploaded_size:s.uploaded_size,total_size:s.total_size,time_left:"0s",percent:100,status:a.status,save_path:i.savePath}),t.globals.uploading.splice(r,1);break}}n["default"].use(D["a"]);var pe=new D["a"].Store({state:{login:!1,isLock:!1,user:{},globals:{pending_download_data:[],send_download_signal:!1,pending_upload_data:[],send_upload_signal:0,press_back_key:!1,share_refresh:!1,pending_download:[],downloading:[],downloaded:[],pending_upload:[],uploading:[],uploaded:[]},websocket:null},mutations:{setUserInfo:function(e,t){e.login=t.login,e.user=t.user},setIsLock:function(e,t){e.isLock=t},initWS:function(e){var t=new WebSocket(z["a"].ws_url);t.onopen=function(){return console.log("WebSocket连接成功")},t.onerror=function(){return console.log("WebSocket连接发生错误")},t.onclose=function(e){return console.log("connection closed (".concat(e,")"))},t.onmessage=function(t){return he(t,e)},e.websocket=t}},actions:{init:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var a,n,r,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.commit,r=!1,e.next=4,$axios.get("user?method=get");case 4:if(s=e.sent,200!==s.status||!s.data||0!==s.data.code){e.next=14;break}return n=s.data.data,r=!0,e.next=10,$axios.get("password?method=exist");case 10:i=e.sent,200===i.status&&i.data&&0===i.data.code&&i.data.data&&(void 0===localStorage.lastUnlockTime||(new Date).getTime()-Number(localStorage.lastUnlockTime)>864e5)&&a("setIsLock",!0),e.next=15;break;case 14:n={};case 15:return a("setUserInfo",{user:n,login:r}),e.abrupt("return",!0);case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}});n["default"].use(h["a"]);var fe=new h["a"]({routes:[{path:"/",name:"home",components:{default:j,nav:se},meta:{auth:!0}},{path:"/login",component:W},{path:"/lock",component:de},{path:"/download",components:{default:function(){return a.e("download").then(a.bind(null,"3971"))},nav:se},meta:{auth:!0}}]});fe.beforeEach(function(e,t,a){if(e.matched.some(function(e){return e.meta.auth})){if(!pe.state.login)return void a("/login");if(pe.state.isLock)return void a("/lock")}a()});var me=fe,ge=a("bc3a"),ve=a.n(ge);/Mobi/i.test(navigator.userAgent)&&(location.href="".concat(location.origin,"/dist_mobile")),n["default"].use(s.a),n["default"].config.productionTip=!1,n["default"].prototype.error=function(e){this.$Message.error({content:e})},window.$axios=ve.a.create({baseURL:"".concat(z["a"].base_url,"/api/v1/")}),pe.dispatch("init").then(function(){new n["default"]({router:me,store:pe,render:function(e){return e(d)}}).$mount("#app")})},"61cd":function(e,t,a){},"67a3":function(e,t,a){"use strict";var n=a("2ff3"),r=a.n(n);r.a},"706c":function(e,t,a){"use strict";var n=a("61cd"),r=a.n(n);r.a},bc52:function(e,t,a){"use strict";var n=a("07d0"),r=a.n(n);r.a},c276:function(e,t,a){"use strict";t["a"]={title:function(e){e=e?e+" - Home":"baidupcs-web",window.document.title=e},formatDateTime:function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0"+n:n;var r=t.getDate();r=r<10?"0"+r:r;var s=t.getHours();s=s<10?"0"+s:s;var i=t.getMinutes(),o=t.getSeconds();return i=i<10?"0"+i:i,o=o<10?"0"+o:o,a+"-"+n+"-"+r+" "+s+":"+i+":"+o},bytesToSize:function(e){if(0===e)return"0 B";var t=1024,a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(e)/Math.log(t));return(e/Math.pow(t,n)).toPrecision(3)+" "+a[n]},sleep:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise(function(t){setTimeout(function(){return t()},e)})}}},cf05:function(e,t,a){e.exports=a.p+"img/logo.7b2b7127.png"},db49:function(e,t,a){"use strict";a("cadf"),a("551c"),a("097d");var n="http:"===location.protocol?"ws:":"wss:",r=location.origin,s="".concat(n,"//").concat(location.host,"/ws");t["a"]={base_url:r,ws_url:s}}});
//# sourceMappingURL=app.fbd8d198.js.map